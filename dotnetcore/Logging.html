<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Paramore by iancooper</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
<div class="wrapper">
    <header>
        <h1>Paramore</h1>
        <p>Libraries and supporting examples for use with the Ports and Adapters and CQRS architectural styles for .NET, with support for Task Queues</p>
        <p class="view"><a href="https://github.com/iancooper/Paramore">View the Project on GitHub <small>iancooper/Paramore</small></a></p>
        <ul>
            <li><a href="https://github.com/iancooper/Paramore/zipball/master">Download <strong>ZIP File</strong></a></li>
            <li><a href="https://github.com/iancooper/Paramore/tarball/master">Download <strong>TAR Ball</strong></a></li>
            <li><a href="https://github.com/iancooper/Paramore">View On <strong>GitHub</strong></a></li>
        </ul>
        <p><a href="../index.html">Paramore Home</a></p>
        <p><a href="Brighter.html">Brighter Home</a></p>
        <a href="HelloWorldExample.html">Next</a>
    </header>
    <section>
        <h1>Introduction</h1>
        <h3>Logger</h3>
        <p>We use <a href="https://github.com/damianh/LibLog">LibLog</a> so that we do not have to depend on a given logging
            library. You will want to add a logger, supported by LibLog to your project (as per the instructions for LibLog)
            if you want to see log output from Brighter.</p>
        <h3>Testing</h3>
        <p>LibLog can either keep the ILog used by the client library private to the library, or allow the client library
            to expose it. Brighter chooses to expose the ILog implementation that we receive from ILog.</p>
        <p>Why?</p>
        <p>When testing you may want to avoid a dependency on the static logger that LibLog wraps your current logging
            framework with, as static variables can make tests behave erratially when run in parallel, or as part of a
            suite. For this reason we tend to add a constructor that explicitly takes an instance of Brighter's ILog to
            allow you to provide an <a href="https://en.wikipedia.org/wiki/Test_double">Test Double</a> of that ILog
            implementation.
        </p>
        <pre>
        <code>
[Subject(typeof(PipelineBuilder<>))]
public class When_Building_A_Handler_For_A_Command
{
    private static PipelineBuilder&lt;MyCommand&gt; s_chain_Builder;
    private static IHandleRequests&lt;MyCommand&gt; s_chain_Of_Responsibility;
    private static RequestContext s_request_context;

    private Establish _context = () =>
    {
        var logger = A.Fake&lt;ILog&gt;();
        var registry = new SubscriberRegistry();
        registry.Register&lt;MyCommand, MyCommandHandler>();
        var handlerFactory = new TestHandlerFactory&lt;MyCommand, MyCommandHandler>(() => new MyCommandHandler(logger));
        s_request_context = new RequestContext();

        s_chain_Builder = new PipelineBuilder&lt;MyCommand>(registry, handlerFactory, logger);
    };

    private Because _of = () => s_chain_Of_Responsibility = s_chain_Builder.Build(s_request_context).First();

    private It _should_have_set_the_context_on_the_handler = () => s_chain_Of_Responsibility.Context.ShouldNotBeNull();
    private It _should_use_the_context_that_we_passed_in = () => s_chain_Of_Responsibility.Context.ShouldBeTheSameAs(s_request_context);
}
        </code>
        </pre>
        <p>However, outside of testing, you rarely need to provide the instance of ILog. This is because in the base class
            <strong>RequestHandler&ltT&gt</strong> the default constructor simply grabs the current logger from LibLog.
        </p>
        <pre>
            <code>
/// <summary>
/// Initializes a new instance of the <see cref="RequestHandler{TRequest}"/> class.
/// </summary>
protected RequestHandler()
: this(LogProvider.GetCurrentClassLogger())
{}
        </code>
        </pre>
        <p>The only time you might want to change this, is if you intend to call a more derived constructor in your own
        code, that contains the ILog used by testing. In this case, you can still keep ILog out of your code, by
        providing the call to LibLog yourself (<strong>LogProvider.GetCurrentClassLogger()</strong>)
        </p>
        <pre>
            <code>
public MailTaskReminderHandler(IAmAMailGateway mailGateway, IAmACommandProcessor commandProcessor)
    : this(mailGateway, commandProcessor, LogProvider.GetCurrentClassLogger())
{}

public MailTaskReminderHandler(IAmAMailGateway mailGateway, IAmACommandProcessor commandProcessor, ILog logger)
    :base(logger)
{
    _mailGateway = mailGateway;
    _commandProcessor = commandProcessor;
}
            </code>
        </pre>
    </section>
    <footer>
        <p>This project is maintained by <a href="https://github.com/iancooper">iancooper</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
    </footer>
</div>
<script src="javascripts/scale.fix.js"></script>
</body>
</html>