<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Paramore by iancooper</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
<div class="wrapper">
    <header>
        <h1>Paramore</h1>
        <p>Libraries and supporting examples for use with the Ports and Adapters and CQRS architectural styles for .NET, with support for Task Queues</p>
        <p class="view"><a href="https://github.com/BrighterCommand/Paramore.Brighter">View the Project on GitHub <small>BrighterCommand/Paramore.Brighter</small></a></p>
        <ul>
            <li><a href="https://github.com/BrighterCommand/Paramore.Brighter/zipball/master">Download <strong>ZIP File</strong></a></li>
            <li><a href="https://github.com/BrighterCommand/Paramore.Brighter/tarball/master">Download <strong>TAR Ball</strong></a></li>
            <li><a href="https://github.com/BrighterCommand/Paramore.Brighter">View On <strong>GitHub</strong></a></li>
        </ul>
        <p><a href="../index.html">Paramore Home</a></p>
        <p><a href="Brighter.html">Brighter Home</a></p>
        <p><a href="PolicyRetryAndCircuitBreaker.html">Next</a></p>
        <p><a href="BuildingAPipeline.html">Prev</a></p>
    </header>
    <section>
    <h1>Brighter</h1>
    <h2>Passing information between Handlers in the Pipeline</h2>
    <p>A key constraint of the Pipes and Filters architectural style is that Filters do not share state. One reason is that this limits your ability to recompose the pipeline as steps must follow other steps.</p>
    <p>However, when dealing with Handlers that implement orthogonal concerns it can be useful to pass context along the chain. Given that many orthogonal concerns have constraints
        about ordering anyway, we can live with the ordering constraints imposed by passing context. So how do you approach passing context from one Handler to another when it is necessary?</p>
    <p>The first thing is to avoid adding extra properties to the Command to support handling state for these orthogonal Filter steps in your pipeline. This couples your <strong>Command</strong> to
        orthogonal concerns and you really only want to bind it to your <strong>Target Handler</strong>.</p>
    <p>Instead we provide a <strong>Context Bag</strong> as part of the <a>Command Dispatcher</a> which is injected into each Handler in the Pipeline. The lifetime of this <strong>Context Bag</strong>
        is the lifetime of the Request (although you will need to take responsibility for freeing any unmanaged resources you place into the <strong>Context Bag</strong> for example when code called after the
        Handler that inserts the resource into the Bag returns to the Handler). </p>
    <pre><code>
public class MyContextAwareCommandHandler : RequestHandler&lt;MyCommand&gt;
{
    public MyContextAwareCommandHandler(ILog logger) : base(logger)
    { }

    public static string TestString { get; set; }

    public override MyCommand Handle(MyCommand command)
    {
        LogContext();
        return base.Handle(command);
    }

    private void LogContext()
    {
        TestString = (string)Context.Bag[&quot;TestString&quot;];
        Context.Bag[&quot;MyContextAwareCommandHandler&quot;] = &quot;I was called and set the context&quot;;
    }
}
    </code></pre>
    <p>Internally we use the <strong>Context Bag</strong> in a number of the Quality of Service supporting Attributes we provide. See <a href="PolicyFallback.html">Fallback</a> for example.</p>
    </section>
    <footer>
        <p>This project is maintained by <a href="https://github.com/iancooper">iancooper</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
    </footer>
</div>
<script src="javascripts/scale.fix.js"></script>
</body>
</html>