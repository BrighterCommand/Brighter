// <auto-generated>
// This file is auto-generated by Paramore.Brighter.Test.Generator
// </auto-generated>

using System.Runtime.CompilerServices;
using System.Threading;
using System.Threading.Tasks;

namespace Paramore.Brighter.RMQ.Async.Tests.MessagingGateway;

/// <summary>
/// Defines a provider for creating and managing asynchronous messaging gateway components for testing.
/// </summary>
public interface IAmAMessageGatewayProactorProvider
{
    /// <summary>
    /// Gets or creates a routing key based on the test name.
    /// </summary>
    /// <param name="testName">The name of the test. Automatically populated with the caller member name.</param>
    /// <returns>A routing key for message routing.</returns>
    RoutingKey GetOrCreateRoutingKey([CallerMemberName]string testName = null!);
    
    /// <summary>
    /// Gets or creates a channel name based on the test name.
    /// </summary>
    /// <param name="testName">The name of the test. Automatically populated with the caller member name.</param>
    /// <returns>A channel name for message consumption.</returns>
    ChannelName GetOrCreateChannelName([CallerMemberName]string testName = null!);

    /// <summary>
    /// Creates a publication configuration for the specified routing key.
    /// </summary>
    /// <param name="routingKey">The routing key for message publishing.</param>
    /// <returns>A publication configuration.</returns>
    Paramore.Brighter.MessagingGateway.RMQ.Async.RmqPublication CreatePublication(RoutingKey routingKey);
    
    /// <summary>
    /// Creates a subscription configuration for the specified routing key and channel.
    /// </summary>
    /// <param name="routingKey">The routing key to subscribe to.</param>
    /// <param name="channelName">The channel name for receiving messages.</param>
    /// <param name="makeChannel">The action to take when the channel is missing.</param>
    /// <returns>A subscription configuration.</returns>
    Paramore.Brighter.MessagingGateway.RMQ.Async.RmqSubscription CreateSubscription(RoutingKey routingKey, ChannelName channelName, OnMissingChannel makeChannel);

    /// <summary>
    /// Creates an asynchronous message producer for the specified publication.
    /// </summary>
    /// <param name="publication">The publication configuration.</param>
    /// <param name="cancellationToken">A cancellation token to cancel the operation.</param>
    /// <returns>An asynchronous message producer.</returns>
    Task<IAmAMessageProducerAsync> CreateProducerAsync(Paramore.Brighter.MessagingGateway.RMQ.Async.RmqPublication publication, CancellationToken cancellationToken = default);
    
    /// <summary>
    /// Creates an asynchronous channel for the specified subscription.
    /// </summary>
    /// <param name="subscription">The subscription configuration.</param>
    /// <param name="cancellationToken">A cancellation token to cancel the operation.</param>
    /// <returns>An asynchronous channel for receiving messages.</returns>
    Task<IAmAChannelAsync> CreateChannelAsync(Paramore.Brighter.MessagingGateway.RMQ.Async.RmqSubscription subscription, CancellationToken cancellationToken = default);

    /// <summary>
    /// Cleans up the specified producer and channel resources.
    /// </summary>
    /// <param name="producer">The message producer to clean up, or null.</param>
    /// <param name="channel">The channel to clean up, or null.</param>
    /// <returns>A task representing the cleanup operation.</returns>
    Task CleanUpAsync(IAmAMessageProducerAsync? producer, IAmAChannelAsync? channel);
}
