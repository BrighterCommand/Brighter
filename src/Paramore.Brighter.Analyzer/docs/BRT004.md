# BRT004: WrapWithAttribute Correct Usage

## Description
This rule ensures that the "Wrap" attributes are correctly applied to methods that map domain requests back to messages (typically `MapToMessage`).

## Why is this a warning?
Applying a "Wrap" attribute to the wrong mapping method can lead to unexpected behavior in the middleware pipeline, such as attempting to wrap a message into a request when it's already a request, or vice-versa.

## How to fix
Ensure that attributes intended for wrapping are applied to the `MapToMessage` method.

### Example
Check your `IAmAMessageMapper<T> ,IAmAMessageMapperAsync<T>` implementation to ensure attributes are on the correct method.
```csharp
    public class WrapWithMapperSample: IAmAMessageMapper<SampleEvent>
    {
      /* ommited code */

       // Error: Attributes should be assigned to the MapToMessage method
        [Compress(0)]
        [ClaimCheck(0)]
        public SampleEvent MapToRequest(Message message)
        {
            /* ommited code*/
        }
       /* ommited code */
    }

  // Fixed: Attributes assigned to the MapToMessage method
        public class WrapWithMapperSample: IAmAMessageMapper<SampleEvent>
    {
      /* ommited code */

        [Compress(0)]
        [ClaimCheck(0)]
        public Message MapToMessage(SampleEvent request, Publication publication)
        {
            /* ommited code*/
        }

       /* ommited code */
    }
```
